import{scheduleDestroyed as t,scheduleDestroy as e}from"@glimmer/global-context";var r=function(t){return t[t.Live=0]="Live",t[t.Destroying=1]="Destroying",t[t.Destroyed=2]="Destroyed",t}(r||{});let n,i,l=new WeakMap;function s(t,e){return null===t?e:Array.isArray(t)?(t.push(e),t):[t,e]}function u(t,e){Array.isArray(t)?t.forEach(e):null!==t&&e(t)}function o(t,e,r){if(Array.isArray(t)&&t.length>1){let r=t.indexOf(e);return t.splice(r,1),t}return null}function c(t){let e=l.get(t);return void 0===e&&(e={parents:null,children:null,eagerDestructors:null,destructors:null,state:r.Live},l.set(t,e)),e}function a(t,e){let r=c(t),n=c(e);return r.children=s(r.children,e),n.parents=s(n.parents,t),e}function d(t,e,r=!1){let n=c(t),i=!0===r?"eagerDestructors":"destructors";return n[i]=s(n[i],e),e}function f(t,e,r=!1){let n=c(t),i=!0===r?"eagerDestructors":"destructors";n[i]=o(n[i],e)}function g(n){let i=c(n);if(i.state>=r.Destroying)return;let{parents:l,children:s,eagerDestructors:a,destructors:d}=i;i.state=r.Destroying,u(s,g),u(a,(t=>t(n))),u(d,(t=>e(n,t))),t((()=>{u(l,(t=>function(t,e){let n=c(e);n.state===r.Live&&(n.children=o(n.children,t))}(n,t))),i.state=r.Destroyed}))}function y(t){let{children:e}=c(t);u(e,g)}function D(t){let e=l.get(t);return void 0!==e&&null!==e.children}function h(t){let e=l.get(t);return void 0!==e&&e.state>=r.Destroying}function p(t){let e=l.get(t);return void 0!==e&&e.state>=r.Destroyed}export{D as _hasDestroyableChildren,i as assertDestroyablesDestroyed,a as associateDestroyableChild,g as destroy,y as destroyChildren,n as enableDestroyableTracking,p as isDestroyed,h as isDestroying,d as registerDestructor,f as unregisterDestructor};
//# sourceMappingURL=index.js.map
